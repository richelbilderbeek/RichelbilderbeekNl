<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
  <title>FAQ: 'Hello World' using Qt Creator under Ubuntu for NDS</title>
  <meta name="description" content="C++ FAQ: 'Hello World' using Qt Creator under Ubuntu for NDS"/>
  <meta name="keywords" content="C++ FAQ: 'Hello World' using Qt Creator under Ubuntu for NDS"/>
  <link rel="stylesheet" href="Richelbilderbeek.css" type="text/css"/>
</head>
<!-- End of head, start of body -->
<body>
<p><a href="index.htm">Go back to Richel Bilderbeek's homepage</a>.</p>
<p><a href="Cpp.htm">Go back to Richel Bilderbeek's C++ page</a>.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<!-- Page header -->
<h1>
  (<a href="Cpp.htm">C++</a>) 
  <img src="PicQtCreator.png" alt="Qt Creator"/><img src="PicUbuntu.png" alt="Ubuntu"/><img src="PicNds.png" alt="NDS"/> 
  <a href="CppHelloWorldQtCreatorUbuntuNds.htm">'Hello World' using Qt Creator under Ubuntu for NDS</a>
</h1>
<p>&nbsp;</p>
<p>A <a href="CppHelloWorld.htm">Hello World</a> program for <a href="CppNds.htm">NDS</a>, using 
<a href="CppQtCreator.htm">Qt Creator</a> under <a href="CppUbuntu.htm">Ubuntu</a> is not simple.
This page actually shows
<a href="CppCrossCompileQtCreatorUbuntuHelloWorldToNds.htm">how to cross-compile a 'Hello World' Qt Creator project from Ubuntu to NDS?</a></p>
<p>&nbsp;</p>
<ul>
  <li><a href="CppHelloWorldQtCreatorUbuntuNds.zip">Download the Qt Creator project 'CppHelloWorldQtCreatorUbuntuNds' (zip)</a></li>
  <li><a href="CppHelloWorldQtCreatorUbuntuNds.png">View a screenshot of 'CppHelloWorldQtCreatorUbuntuNds' (png)</a></li>
</ul>
<p>&nbsp;</p>
<p>The <a href="Tools.htm">tool</a> <a href="ToolNdsmake.htm">ndsmake</a> allows to 
<a href="CppCrossCompile.htm">cross-compile</a>
directly from <a href="CppQtCreator.htm">Qt Creator</a> under Ubuntu to NDS.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>Prerequisites</h2>
<p>&nbsp;</p>
<p>devkitpro needs to be installed in /opt/devkitpro. Follow the steps described by [1].
For the <a href="CppQtCreator.htm">Qt Creator</a> project
to compile, also install the libnds source code (the libnds-src-1.4.7 tarball).</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>Folder structure</h2>
<p>&nbsp;</p>
<p>I have used the following folder structure (as in the downloadable project above):</p>
<ul>
  <li>build
    <ul>
      <li>CppHelloWorldQtCreatorUbuntuNds.map: generated by the important <a href="CppMakefile.htm">Makefile</a></li>
      <li>main.d: generated by the important <a href="CppMakefile.htm">Makefile</a></li>
      <li>main.o: generated by the important <a href="CppMakefile.htm">Makefile</a></li>
    </ul>
  </li>
  <li>source
    <ul>
      <li>CppHelloWorldQtCreatorUbuntuNds (unknown <a href="CppOs.htm">OS</a> executable)</li>
      <li>CppHelloWorldQtCreatorUbuntuNds.pro</li>
      <li>CppHelloWorldQtCreatorUbuntuNds.pro.user</li>
      <li>main.cpp: where our code lives</li>
      <li>main.o: useless object file generated by <a href="CppQtCreator.htm">QtCreator</a></li>
      <li><a href="CppMakefile.htm">Makefile</a>: useless <a href="CppMakefile.htm">Makefile</a> generated by <a href="CppQtCreator.htm">QtCreator</a></li>
    </ul>
  </li>
  <li><a href="CppMakefile.htm">Makefile</a>: the important <a href="CppMakefile.htm">Makefile</a></li>
  <li>CppHelloWorldQtCreatorUbuntuNds.elf: elf file generated by the important <a href="CppMakefile.htm">Makefile</a></li>
  <li>CppHelloWorldQtCreatorUbuntuNds.nds: the <a href="CppNds.htm">NDS</a> executable</li>
</ul>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>main.cpp</h2>
<p>&nbsp;</p>
<p>A <a href="CppHelloWorld.htm">Hello World</a> program for <a href="CppNds.htm">NDS</a> additionally needs
to call 'consoleDemoInit' from the <a href="CppLibnds.htm">libnds</a> <a href="CppLibrary.htm">library</a>
and end in a waiting loop: if the program reaches the end of <a href="CppMain.htm">main</a>, it terminates.</p>
<p>&nbsp;</p>
<!-- start of code -->
<table border = "1"><tr><td><code>
<a href="CppInclude.htm">#include</a> &lt;nds.h&gt;<br/>
<a href="CppInclude.htm">#include</a> &lt;<a href="CppIostreamH.htm">iostream</a>&gt;<br/>
	<br/>
<b><a href="CppInt.htm">int</a></b> <a href="CppMain.htm">main</a>()<br/>
{<br/>
&nbsp;&nbsp;<a href="CppComment.htm">//</a>consoleDemoInit is obligatory<br/>
&nbsp;&nbsp;consoleDemoInit();<br/>
<br/>
&nbsp;&nbsp;<a href="CppCout.htm">std::cout</a> <a href="CppOperatorStreamOut.htm">&lt;&lt;</a> "Hello <a href="CppNds.htm">NDS</a>\n";<br/>
<br/>
&nbsp;&nbsp;<a href="CppComment.htm">//</a>Infinite waiting<br/>
&nbsp;&nbsp;<b><a href="CppWhile.htm">while</a></b> (1) {}<br/>
}<br/>
</code></td></tr></table>
<!-- end of the code -->
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2><a href="CppQtProjectFile.htm">Project file</a></h2>
<p>&nbsp;</p>
<p>A valid <a href="CppQtCreator.htm">Qt Creator</a> <a href="CppQtProjectFile.htm">project file</a>
is practical for development. It will result in an unknown <a href="CppOs.htm">OS</a>'s executable.</p>
<p>&nbsp;</p>
<!-- start of code -->
<table border = "1"><tr><td><code>
#-------------------------------------------------<br/>
#<br/>
# Project created by QtCreator 2010-10-07T22:25:11<br/>
#<br/>
#-------------------------------------------------<br/>
INCLUDEPATH += /opt/devkitpro/libnds-1.4.7/include<br/>
INCLUDEPATH += /opt/devkitpro/libnds-src-1.4.7/include/nds<br/>
INCLUDEPATH += /opt/devkitpro/devkitARM/arm-eabi/include<br/>
LIBS += -L/opt/devkitpro/libnds-1.4.7/lib -lnds9<br/>
LIBS += -L/opt/devkitpro/devkitARM/arm-eabi/lib -lstdc++<br/>
DEFINES += ARM9<br/>
TARGET = CppHelloWorldQtCreatorUbuntuNds<br/>
CONFIG&nbsp;&nbsp; += console<br/>
CONFIG -= qt<br/>
CONFIG&nbsp;&nbsp; -= app_bundle<br/>
TEMPLATE = app<br/>
SOURCES += main.cpp<br/>
QMAKE_CC = /opt/devkitpro/devkitARM/bin/arm-eabi-g++<br/>
QMAKE_CXX = /opt/devkitpro/devkitARM/bin/arm-eabi-g++<br/>
QMAKE_LINK = /opt/devkitpro/devkitARM/bin/arm-eabi-g++<br/>
QMAKE_LFLAGS = -T/opt/devkitpro/devkitARM/arm-eabi/lib/ds_arm9.ld<br/>
</code></td></tr></table>
<!-- end of the code -->
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2><a href="CppMakefile.htm">Makefile</a></h2>
<p>&nbsp;</p>
<p>The <a href="CppMakefile.htm">Makefile</a> generated by <a href="CppQtCreator.htm">Qt Creator</a>
will not result in a valid .nds file. This is a correct <a href="CppMakefile.htm">Makefile</a>:</p>
<p>&nbsp;</p>
<!-- start of code -->
<table border = "1"><tr><td><code>
#---------------------------------------------------------------------------------<br/>
.SUFFIXES:<br/>
#---------------------------------------------------------------------------------<br/>
<br/>
ifeq ($(strip $(DEVKITARM)),)<br/>
$(error "Please set DEVKITARM in your environment. export DEVKITARM=&lt;path to&gt;devkitARM")<br/>
endif<br/>
<br/>
include $(DEVKITARM)/ds_rules<br/>
<br/>
#---------------------------------------------------------------------------------<br/>
# TARGET is the name of the output<br/>
# BUILD is the directory where object files &amp; intermediate files will be placed<br/>
# SOURCES is a list of directories containing source code<br/>
# INCLUDES is a list of directories containing extra header files<br/>
#---------------------------------------------------------------------------------<br/>
TARGET		:=	$(shell basename $(CURDIR))<br/>
BUILD		:=	build<br/>
SOURCES		:=	gfx source data&nbsp;&nbsp;<br/>
INCLUDES	:=	include build /opt/devkitpro/libnds-1.4.7/include<br/>
<br/>
#---------------------------------------------------------------------------------<br/>
# options for code generation<br/>
#---------------------------------------------------------------------------------<br/>
ARCH	:=	-mthumb -mthumb-interwork<br/>
<br/>
CFLAGS	:=	-g -Wall -O2\<br/>
 			-march=armv5te -mtune=arm946e-s -fomit-frame-pointer\<br/>
			-ffast-math \<br/>
			$(ARCH)<br/>
<br/>
CFLAGS	+=	$(INCLUDE) -DARM9<br/>
CXXFLAGS	:= $(CFLAGS) -fno-rtti -fno-exceptions<br/>
<br/>
ASFLAGS	:=	-g $(ARCH)<br/>
LDFLAGS	=	-specs=ds_arm9.specs -g $(ARCH) -mno-fpu -Wl,-Map,$(notdir $*.map)<br/>
<br/>
#---------------------------------------------------------------------------------<br/>
# any extra libraries we wish to link with the project<br/>
#---------------------------------------------------------------------------------<br/>
LIBS	:= -lnds9<br/>
 <br/>
 <br/>
#---------------------------------------------------------------------------------<br/>
# list of directories containing libraries, this must be the top level containing<br/>
# include and lib<br/>
#---------------------------------------------------------------------------------<br/>
LIBDIRS	:=	$(LIBNDS)<br/>
 <br/>
#---------------------------------------------------------------------------------<br/>
# no real need to edit anything past this point unless you need to add additional<br/>
# rules for different file extensions<br/>
#---------------------------------------------------------------------------------<br/>
ifneq ($(BUILD),$(notdir $(CURDIR)))<br/>
#---------------------------------------------------------------------------------<br/>
 <br/>
export OUTPUT	:=	$(CURDIR)/$(TARGET)<br/>
 <br/>
export VPATH	:=	$(foreach dir,$(SOURCES),$(CURDIR)/$(dir))<br/>
export DEPSDIR	:=	$(CURDIR)/$(BUILD)<br/>
<br/>
CFILES		:=	$(foreach dir,$(SOURCES),$(notdir $(wildcard $(dir)/*.c)))<br/>
CPPFILES	:=	$(foreach dir,$(SOURCES),$(notdir $(wildcard $(dir)/*.cpp)))<br/>
SFILES		:=	$(foreach dir,$(SOURCES),$(notdir $(wildcard $(dir)/*.s)))<br/>
BINFILES	:=	$(foreach dir,$(SOURCES),$(notdir $(wildcard $(dir)/*.bin)))<br/>
 <br/>
#---------------------------------------------------------------------------------<br/>
# use CXX for linking C++ projects, CC for standard C<br/>
#---------------------------------------------------------------------------------<br/>
ifeq ($(strip $(CPPFILES)),)<br/>
#---------------------------------------------------------------------------------<br/>
	export LD	:=	$(CC)<br/>
#---------------------------------------------------------------------------------<br/>
else<br/>
#---------------------------------------------------------------------------------<br/>
	export LD	:=	$(CXX)<br/>
#---------------------------------------------------------------------------------<br/>
endif<br/>
#---------------------------------------------------------------------------------<br/>
<br/>
export OFILES	:=	$(BINFILES:.bin=.o) \<br/>
					$(CPPFILES:.cpp=.o) $(CFILES:.c=.o) $(SFILES:.s=.o)<br/>
 <br/>
export INCLUDE	:=	$(foreach dir,$(INCLUDES),-I$(CURDIR)/$(dir)) \<br/>
					$(foreach dir,$(LIBDIRS),-I$(dir)/include) \<br/>
					$(foreach dir,$(LIBDIRS),-I$(dir)/include) \<br/>
					-I$(CURDIR)/$(BUILD)<br/>
 <br/>
export LIBPATHS	:=	$(foreach dir,$(LIBDIRS),-L$(dir)/lib)<br/>
 <br/>
.PHONY: $(BUILD) clean<br/>
 <br/>
#---------------------------------------------------------------------------------<br/>
$(BUILD):<br/>
	@[ -d $@ ] || mkdir -p $@<br/>
	@make --no-print-directory -C $(BUILD) -f $(CURDIR)/Makefile<br/>
 <br/>
#---------------------------------------------------------------------------------<br/>
clean:<br/>
	@echo clean ...<br/>
	@rm -fr $(BUILD) $(TARGET).elf $(TARGET).nds $(TARGET).ds.gba <br/>
 <br/>
 <br/>
#---------------------------------------------------------------------------------<br/>
else<br/>
 <br/>
DEPENDS	:=	$(OFILES:.o=.d)<br/>
 <br/>
#---------------------------------------------------------------------------------<br/>
# main targets<br/>
#---------------------------------------------------------------------------------<br/>
$(OUTPUT).nds	: 	$(OUTPUT).elf<br/>
$(OUTPUT).elf	:	$(OFILES)<br/>
 <br/>
#---------------------------------------------------------------------------------<br/>
%.o	:	%.bin<br/>
#---------------------------------------------------------------------------------<br/>
	@echo $(notdir $&lt;)<br/>
	$(bin2o)<br/>
 <br/>
 <br/>
-include $(DEPENDS)<br/>
 <br/>
#---------------------------------------------------------------------------------------<br/>
endif<br/>
#---------------------------------------------------------------------------------------<br/>
</code></td></tr></table>
<!-- end of the code -->
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2><a href="CppMake.htm">make</a></h2>
<p>&nbsp;</p>
<p><a href="CppQtCreator.htm">Qt Creator</a> does not generate a valid executable. Using a terminal, navigate
to the folder with the important <a href="CppMakefile.htm">makefile</a>. Then call <a href="CppMake.htm">make</a>:</p>
<p>&nbsp;</p>
<!-- start of code -->
<table border = "1"><tr><td><code>
make<br/>
</code></td></tr></table>
<!-- end of the code -->
<p>&nbsp;</p>
<p>This hopefully results in the following success output:</p>
<p>&nbsp;</p>
<!-- start of code -->
<table border = "1"><tr><td><code>
Nintendo DS rom tool 1.48 - Jul&nbsp;&nbsp;7 2010<br/>
by Rafael Vuijk, Dave Murphy, Alexei Karpenko<br/>
built ... CppHelloWorldQtCreatorUbuntuNds.nds<br/>
</code></td></tr></table>
<!-- end of the code -->
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>Running the program</h2>
<p>&nbsp;</p>
<p>The generated <a href="CppNds.htm">NDS</a> executable (CppHelloWorldQtCreatorUbuntuNds.nds)
can be run in an <a href="CppNds.htm">NDS</a> <a href="CppEmulator.htm">emulator</a>
or copied on an R4 (and other ways I do not know the details (and success) of, like WiFi-ing the code, or passing 
through a Gameboy Advanced)</p>
<p>&nbsp;</p>
<p>Personally, I call the <a href="CppNds.htm">NDS</a> <a href="CppEmulator.htm">emulator</a> from command line:</p>
<p>&nbsp;</p>
<!-- start of code -->
<table border = "1"><tr><td><code>
desmume CppHelloWorldQtCreatorUbuntuNds.nds<br/>
</code></td></tr></table>
<!-- end of the code -->
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2><a href="CppReferences.htm">References</a></h2>
<p>&nbsp;</p>
<ol>
  <li><a href="http://devkitpro.org/wiki/Getting_Started/devkitARM">Devkitpro wiki 'Getting started/devkitARM'</a><br/>
    &nbsp;<br/>
    <!-- start of code -->
    <table border = "1"><tr><td><code>
    The first thing that you need to do is create a folder for the devkitPro toolchains. Start by opening a terminal - on OSX use the apple key + space, then type terminal. In the terminal window type the following command to create a new folder - all these commands are executed by pressing the return key. You'll need to create the initial folder with root privileges<br/>
    <br/>
    sudo mkdir -p /opt/devkitpro<br/>
    <br/>
    Once you've done that you can grant world access to the folder so you can extract the archives with normal privileges.<br/>
    <br/>
    sudo chmod 777 /opt/devkitpro<br/>
    <br/>
    When we're done the layout for your devkitPro folder should end up like this, each folder links to the appropriate sourceforge package.<br/>
    <br/>
    devkitpro<br/>
    &nbsp;&nbsp; |<br/>
    &nbsp;&nbsp; +-- devkitARM<br/>
    &nbsp;&nbsp; +-- examples<br/>
    &nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |<br/>
    &nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; +-- gba<br/>
    &nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; +-- gp32<br/>
    &nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; +-- nds<br/>
    &nbsp;&nbsp; +-- libgba<br/>
    &nbsp;&nbsp; +-- libmirko<br/>
    &nbsp;&nbsp; +-- libnds<br/>
    <br/>
    Nothing else should be placed inside these folders unless otherwise instructed by the devkitPro toolchain maintainers. On Windows several of these folders are removed and replaced by the update system.<br/>
    <br/>
    The first package to install is the devkitARM tarball, obtained from the devkitARM link shown above. Download the appropriate tarball for your host platform - the files are named as devkitARM_&lt;revision&gt;-&lt;processor&gt;-&lt;os&gt;.tar.bz2. For OSX we provide universal binaries - devkitARM_&lt;revision&gt;-osx.tar.bz2.<br/>
    <br/>
    Once the file is downloaded then you need to extract it into the devkitpro folder<br/>
    <br/>
    cd /opt/devkitpro<br/>
    tar -xvjf &lt;file you downloaded&gt;<br/>
    <br/>
    Obviously replace &lt;file you downloaded&gt; with the name of the file obtained from sourceforge. On OSX you can simply drag &amp; drop the downloaded file into the terminal window to get the file path.<br/>
    <br/>
    Now you need to obtain the support libraries for your target platform - we'll start with the Nintendo DS libraries.<br/>
    <br/>
    Download the latest binary of libnds then create a new folder and extract the tarball from the terminal window as before. Note: This is the file without "-src-" in the name.<br/>
    <br/>
    mkdir libnds<br/>
    cd libnds<br/>
    tar -xvjf &lt;libnds tarball&gt;<br/>
    <br/>
    Again, replace &lt;libnds tarball&gt; with the name of the file obtained from sourceforge. On OSX you can simply drag &amp; drop the downloaded file into the terminal window to get the file path.<br/>
    <br/>
    Now download libfat-nds, this is the libfat-nds tarball and may not be in the release at the top of the list. You may need to expand the second section to find the appropriate file. This should be extracted to the same folder as the libnds tarball earlier.<br/>
    <br/>
    tar -xvjf &lt;libfat-nds tarball&gt;<br/>
    <br/>
    Download the dswifi tarball and extract in the same place.<br/>
    <br/>
    tar -xvjf &lt;dswifi tarball&gt;<br/>
    <br/>
    Download the maxmod tarball and extract in the same place.<br/>
    <br/>
    tar -xvjf &lt;maxmod-nds tarball&gt;<br/>
    <br/>
    Download the libfilesystem tarball and extract in the same place.<br/>
    <br/>
    tar -xvjf &lt;libfilesystem tarball&gt;<br/>
    <br/>
    Lastly you'll need the arm7 binary that handles the wifi, audio and touchscreen on the DS.<br/>
    <br/>
    Download the default arm7 tarball and extract, still inside the libnds folder.<br/>
    <br/>
    tar -xvjf &lt;default arm7 tarball&gt;<br/>
    <br/>
    Now all that remains for DS programming is the examples archive. Move back to the devkitpro folder and create an examples/nds folder.<br/>
    <br/>
    cd ..<br/>
    mkdir -p examples/nds<br/>
    cd examples/nds<br/>
    <br/>
    Grab the nds examples archive from sourceforge &amp; extract it here.<br/>
    <br/>
    tar -xvjf &lt;examples tarball&gt;<br/>
    <br/>
    Add these variables in your execution environment, for instance, editing the .bashrc file located in your home folder:<br/>
    <br/>
    export DEVKITPRO=/opt/devkitpro<br/>
    export DEVKITARM=$DEVKITPRO/devkitARM<br/>
    <br/>
    </code></td></tr></table>
    <!-- end of the code -->
    &nbsp;<br/>
  </li>
</ol>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><a href="Cpp.htm">Go back to Richel Bilderbeek's C++ page</a>.</p>
<p><a href="index.htm">Go back to Richel Bilderbeek's homepage</a>.</p>
<p>&nbsp;</p>
<p><a href="http://validator.w3.org/check?uri=referer"><img src="valid-xhtml10.png" alt="Valid XHTML 1.0 Strict" height="31" width="88" /></a></p>
</body>
</html>
