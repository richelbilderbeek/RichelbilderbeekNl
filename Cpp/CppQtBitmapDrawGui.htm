<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
  <title>Qt Creator: How to draw on a QBitmap with using the GUI designer?</title>
  <meta name="description" content="C++ Qt Creator How to draw on a QBitmap with using the GUI designer?"/>
  <meta name="keywords" content="C++ Qt Creator How to How to draw on a QBitmap with using the GUI designer?"/>
  <link rel="stylesheet" href="Richelbilderbeek.css" type="text/css"/>
</head>
<!-- End of head, start of body -->
<body>
<p><a href="index.htm">Go back to Richel Bilderbeek's homepage</a>.</p>
<p><a href="Cpp.htm">Go back to Richel Bilderbeek's C++ page</a>.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<!-- Page header -->
<h1>(<a href="Cpp.htm">C++</a>) <img src="PicQt.png" alt="Qt"/> <a href="CppQtBitmapDrawGui.htm">How to draw on a QBitmap with using the GUI designer?</a></h1>
<p>&nbsp;</p>
<p>This page describes how to draw on a <a href="CppQBitmap.htm">QBitmap</a> with using the GUI designer, resulting in <a href="CppQtBitmapDrawGui.png">this screenshot</a>. You can also directly <a href="CppQtBitmapDrawGui.zip">download the CppQtBitmapDrawGui source and binary code</a>.</p>
<p>&nbsp;</p>
<!-- start of code -->
<table border = "1"><tr><td><code>
Probably, you do not want to use a <a href="CppQBitmap.htm">QBitmap</a>, as it can only display monochrome (that is black and white) color!<br/>
</code></td></tr></table>
<!-- end of the code -->
<p>&nbsp;</p>
<p>To create this program in <a href="CppQtCreator.htm">Qt Creator</a>, you can follow the steps below:</p>
<ul>
  <li>Step #1: Setting up the Qt4 Gui application project</li>
  <li>Step #2: Setting up the GUI</li>
  <li>Step #3: Coding the <a href="CppDeclaration.htm">declarations</a> of the dialog</li>
  <li>Step #4: Coding the <a href="CppDefinition.htm">definitions</a> of the dialog</li>
  <li>Step #5: Running the program</li>
</ul>


<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>Step #1: Setting up the Qt4 Gui application project</h2>
<p>&nbsp;</p>
<ol>
  <li>Start <a href="CppQtCreator.htm">Qt Creator</a>.</li>
  <li>If you are not shown the welcome screen, click on 'Welcome' on the left</li>
  <li>If, in the welcome screen, the 'Develop' tab is not shown, click on 'Develop' to view the <a href="CppQtCreatorWelcomeDevelop_2_1_0.png">Welcome screen Develop tab</a></li>
  <li>In the <a href="CppQtCreatorWelcomeDevelop_2_1_0.png">Welcome screen Develop tab</a>, click 'Create New Project' to go to the <a href="CppQtCreatorNewProject_2_5_2.png">New project dialog</a></li> 
  <li>In the <a href="CppQtCreatorNewProject_2_5_2.png">New project dialog</a>, click 'QT4 Gui Application' to go to the <a href="CppQtIntroduction.png">introduction and project location dialog</a></li>
  <li>In the <a href="CppQtIntroduction.png">Introduction and project location dialog</a>, you must specify a name and location to save your (project) files. For example, after 'Name' type 'HelloWorldGui'. Click next</li>
  <li>In the <a href="CppQtCreatorSelectRequiredModules.png">select required modules dialog</a>, all checks are correct (only QtCore and QtGui are checked), so click 'Next'</li>
  <li>In the <a href="CppQtClassInformation.png">class Information dialog</a>, change the 'Base class' to 'QDialog' and click 'Next'</li>
  <li>In the <a href="CppQtProjectManagement.png">project management dialog</a>, click 'Finish'</li>
</ol>
<p>&nbsp;</p>
<p>Now your Qt4 Gui application project is successfully set up. Your screen might look like <a href="CppQtHelloWorldWindowedGui1.png">this</a>.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>Step #2: Setting up the GUI</h2>
<p>&nbsp;</p>
<ol>
  <li>On the left menu bar, you can see you are now in 'Edit' mode (instead of 'Welcome' mode). You can see your project right of this menu bar. You can see a 'QtHelloWorldGui' project folder, containing the following files:
    <ol>
      <li>QtHelloWorldGui.pro</li>
      <li>main.cpp</li>
      <li>dialog.cpp</li>
      <li>dialog.h</li>
      <li>dialog.ui</li>
    </ol>
    Double-click on 'dialog.ui' to be taken to the GUI designer.
  </li>
  <li>Your screen might then look like <a href="CppQtHelloWorldWindowedGui2.png">this</a>. I prefer to press 'Alt-0' to remove the Project manager sidebar and my screen looks like <a href="CppQtHelloWorldWindowedGui3.png">this</a>.</li>
  <li>From the Widget toolbox, place a PushButton (under 'Buttons') and Label (under 'Display Widgets') on the MainWindow.</li>
  <li>Click on the PushButton and change the Text property to 'Invert colors', like <a href="CppQtPixmapDrawGui2.png">this screenshot</a>.</li>
  <li>Click on the Label and change the Bitmap property to 'Choose file' and select an image like <a href="256x256.png">256x256.png</a>, like <a href="CppQtPixmapDrawGui3.png">this screenshot</a>.</li>
  <li>Right-click on the Dialog and select 'Layout -> Lay out vertically'.</li>
  <li>Right-click on the Dialog and select 'Size contraints -> Set minimum size'.</li>
</ol>
<p>&nbsp;</p>
<p>You have now successfully set up the GUI. Your screen might then look like <a href="CppQtPixmapDrawGui4.png">this</a>.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>Step #3: Coding the <a href="CppDeclaration.htm">declarations</a> of the dialog</h2>
<p>&nbsp;</p>
<ol>
  <li>Press 'ALT-0' to view the Project Manager sidebar again. Your screen might then look like <a href="CppQtHelloWorldWindowedGui5.png">this</a>.</li>
  <li>Double-click on 'dialog.h to be taken to the source of dialog.h:
    <!-- start of code -->
    <table border = "1"><tr><td><code>
    <a href="CppIfndef.htm">#ifndef</a> DIALOG_H<br/>
    <a href="CppDefine.htm">#define</a> DIALOG_H<br/>
    <br/>
    <b><a href="CppNamespace.htm">namespace</a></b> Ui {<br/>
    &nbsp;&nbsp;<b><a href="CppClass.htm">class</a></b> Dialog;<br/>
    }<br/>
    <br/>
    <b><a href="CppClass.htm">class</a></b> Dialog : <b><a href="CppPublic.htm">public</a></b> <a href="CppQDialog.htm">QDialog</a> {<br/>
    &nbsp;&nbsp;<a href="CppQ_OBJECT.htm">Q_OBJECT</a><br/>
    <b><a href="CppPublic.htm">public</a></b>:<br/>
    &nbsp;&nbsp;Dialog(<a href="CppQWidget.htm">QWidget</a> *parent <a href="CppOperatorAssign.htm">=</a> 0);<br/>
    &nbsp;&nbsp;~Dialog();<br/>
    <br/>
    <b><a href="CppProtected.htm">protected</a></b>:<br/>
    &nbsp;&nbsp;<b><a href="CppVoid.htm">void</a></b> changeEvent(<a href="CppQEvent.htm">QEvent</a> *e);<br/>
    <br/>
    <b><a href="CppPrivate.htm">private</a></b>:<br/>
    &nbsp;&nbsp;<a href="CppUi.htm">Ui</a>::Dialog *ui;<br/>
    };<br/>
    <a href="CppEndif.htm">#endif</a> <a href="CppComment.htm">//</a> DIALOG_H<br/>
    </code></td></tr></table>
    <!-- end of the code -->
  </li>
  <li>Change this code to the following:
    <!-- start of code -->
    <table border = "1"><tr><td><code>
    <a href="CppIfndef.htm">#ifndef</a> DIALOG_H<br/>
    <a href="CppDefine.htm">#define</a> DIALOG_H<br/>
    <br/>
    <a href="CppInclude.htm">#include</a> &lt;<a href="CppQDialog.htm">QDialog</a>&gt;<br/>
    <a href="CppInclude.htm">#include</a> &lt;<a href="CppQPainter.htm">QPainter</a>&gt;<br/>
    <a href="CppInclude.htm">#include</a> &lt;<a href="CppQBitmap.htm">QBitmap</a>&gt;<br/>
    <a href="CppInclude.htm">#include</a> &lt;<a href="CppQTimer.htm">QTimer</a>&gt;<br/>
    <br/>
    <b><a href="CppNamespace.htm">namespace</a></b> Ui {<br/>
    &nbsp;&nbsp;<b><a href="CppClass.htm">class</a></b> Dialog;<br/>
    }<br/>
    <br/>
    <b><a href="CppClass.htm">class</a></b> Dialog : <b><a href="CppPublic.htm">public</a></b> <a href="CppQDialog.htm">QDialog</a> {<br/>
    &nbsp;&nbsp;<a href="CppQ_OBJECT.htm">Q_OBJECT</a><br/>
    <b><a href="CppPublic.htm">public</a></b>:<br/>
    &nbsp;&nbsp;Dialog(<a href="CppQWidget.htm">QWidget</a> *parent <a href="CppOperatorAssign.htm">=</a> 0);<br/>
    &nbsp;&nbsp;~Dialog();<br/>
    <br/>
    <b><a href="CppProtected.htm">protected</a></b>:<br/>
    &nbsp;&nbsp;<b><a href="CppVoid.htm">void</a></b> changeEvent(<a href="CppQEvent.htm">QEvent</a> *e);<br/>
    <br/>
    <b><a href="CppPrivate.htm">private</a></b> <b><a href="CppSlots.htm">slots</a></b>:<br/>
    &nbsp;&nbsp;<b><a href="CppVoid.htm">void</a></b> OnClick();<br/>
    &nbsp;&nbsp;<b><a href="CppVoid.htm">void</a></b> OnTick();<br/>
    <br/>
    <b><a href="CppPrivate.htm">private</a></b>:<br/>
    &nbsp;&nbsp;<a href="CppUi.htm">Ui</a>::Dialog *ui;<br/>
    &nbsp;&nbsp;<a href="CppQBitmap.htm">QBitmap</a> m_bitmap;<br/>
    &nbsp;&nbsp;<a href="CppQPainter.htm">QPainter</a> m_painter;<br/>
    &nbsp;&nbsp;<b><a href="CppInt.htm">int</a></b> m_z;<br/>
    &nbsp;&nbsp;<a href="CppQTimer.htm">QTimer</a> m_timer;<br/>
    };<br/>
    <br/>
    <a href="CppEndif.htm">#endif</a> <a href="CppComment.htm">//</a> DIALOG_H<br/>
    </code></td></tr></table>
    <!-- end of the code -->
  </li>
</ol>
<p>&nbsp;</p>
<p>Note that if you try to execute the program, you get the following <a href="CppLinkError.htm">(link) error</a>:</p>
<!-- start of code -->
<table border = "1"><tr><td><code>
/MyFolder/moc_mainwindow.cpp:66: undefined reference to 'Dialog::OnClick()'<br/>
/MyFolder/moc_mainwindow.cpp:66: undefined reference to 'Dialog::OnTick()'<br/>
</code></td></tr></table>
<!-- end of the code -->
<p>&nbsp;</p>
<p>This <a href="CppLinkError.htm">(link) error</a> is correct: the <a href="CppMemberFunction.htm">member functions</a> Dialog::OnClick and Dialog::OnTick are <a href="CppDeclaration.htm">declared</a> but not yet <a href="CppDefinition.htm">defined</a>.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>Step #4: Coding the <a href="CppDefinition.htm">definitions</a> of the dialog</h2>
<p>&nbsp;</p>
<ol>
  <li>Press 'ALT-0' to view the Project Manager sidebar again. Your screen might then look like <a href="CppQtHelloWorldWindowedGui6.png">this</a>.</li>
  <li>Double-click on 'dialog.cpp to be taken to the source of dialog.cpp:
    <!-- start of code -->
    <table border = "1"><tr><td><code>
    <a href="CppInclude.htm">#include</a> "dialog.h"<br/>
    <a href="CppInclude.htm">#include</a> "ui_dialog.h"<br/>
    <br/>
    Dialog::Dialog(<a href="CppQWidget.htm">QWidget</a> *parent) :<br/>
    &nbsp;&nbsp;&nbsp;&nbsp;<a href="CppQDialog.htm">QDialog</a>(parent),<br/>
    &nbsp;&nbsp;&nbsp;&nbsp;ui(<b><a href="CppNew.htm">new</a></b> <a href="CppUi.htm">Ui</a>::Dialog)<br/>
    {<br/>
    &nbsp;&nbsp;ui-&gt;setupUi(<b><a href="CppThis.htm">this</a></b>);<br/>
    }<br/>
    <br/>
    Dialog::~Dialog()<br/>
    {<br/>
    &nbsp;&nbsp;<b><a href="CppDelete.htm">delete</a></b> ui;<br/>
    }<br/>
    <br/>
    <b><a href="CppVoid.htm">void</a></b> Dialog::changeEvent(<a href="CppQEvent.htm">QEvent</a> *e)<br/>
    {<br/>
    &nbsp;&nbsp;<a href="CppQDialog.htm">QDialog</a>::changeEvent(e);<br/>
    &nbsp;&nbsp;<b><a href="CppSwitch.htm">switch</a></b> (e-&gt;type()) {<br/>
    &nbsp;&nbsp;<b><a href="CppCase.htm">case</a></b> <a href="CppQEvent.htm">QEvent</a>::LanguageChange:<br/>
    &nbsp;&nbsp;&nbsp;&nbsp;ui-&gt;retranslateUi(<b><a href="CppThis.htm">this</a></b>);<br/>
    &nbsp;&nbsp;&nbsp;&nbsp;<b><a href="CppBreak.htm">break</a></b>;<br/>
    &nbsp;&nbsp;<b><a href="CppDefault.htm">default</a></b>:<br/>
    &nbsp;&nbsp;&nbsp;&nbsp;<b><a href="CppBreak.htm">break</a></b>;<br/>
    &nbsp;&nbsp;}<br/>
    }<br/>
    </code></td></tr></table>
    <!-- end of the code -->
  </li>
  <li>Change this code to the following:
    <!-- start of code -->
    <table border = "1"><tr><td><code>
    <a href="CppInclude.htm">#include</a> &lt;<a href="CppQPainter.htm">QPainter</a>&gt;<br/>
    <br/>
    <a href="CppInclude.htm">#include</a> "dialog.h"<br/>
    <a href="CppInclude.htm">#include</a> "ui_dialog.h"<br/>
    <br/>
    Dialog::Dialog(<a href="CppQWidget.htm">QWidget</a> *parent) :<br/>
    &nbsp;&nbsp;&nbsp;&nbsp;<a href="CppQDialog.htm">QDialog</a>(parent),<br/>
    &nbsp;&nbsp;&nbsp;&nbsp;ui(<b><a href="CppNew.htm">new</a></b> <a href="CppUi.htm">Ui</a>::Dialog),<br/>
    &nbsp;&nbsp;&nbsp;&nbsp;m_bitmap("256x256.png"),<br/>
    &nbsp;&nbsp;&nbsp;&nbsp;m_painter(&amp;m_bitmap),<br/>
    &nbsp;&nbsp;&nbsp;&nbsp;m_z(0)<br/>
    {<br/>
    &nbsp;&nbsp;ui-&gt;setupUi(<b><a href="CppThis.htm">this</a></b>);<br/>
    &nbsp;&nbsp;<a href="CppAssert.htm">assert</a>(<a href="CppQFile.htm">QFile</a>::exists("256x256.png") <a href="CppOperatorLogicalAnd.htm">&amp;&amp;</a> "Please put a file called 256x256.png in the executable its folder");<br/>
    &nbsp;&nbsp;QObject::connect(ui-&gt;pushButton,<a href="CppSignalMacro.htm">SIGNAL</a>(clicked()),<b><a href="CppThis.htm">this</a></b>,<a href="CppSLOT.htm">SLOT</a>(OnClick()));<br/>
    &nbsp;&nbsp;QObject::connect(&amp;m_timer,<a href="CppSignalMacro.htm">SIGNAL</a>(timeout()),<b><a href="CppThis.htm">this</a></b>,<a href="CppSLOT.htm">SLOT</a>(OnTick()));<br/>
    &nbsp;&nbsp;OnTick();<br/>
    &nbsp;&nbsp;m_timer.start(10);<br/>
    }<br/>
    <br/>
    Dialog::~Dialog()<br/>
    {<br/>
    &nbsp;&nbsp;<b><a href="CppDelete.htm">delete</a></b> ui;<br/>
    }<br/>
    <br/>
    <b><a href="CppVoid.htm">void</a></b> Dialog::changeEvent(<a href="CppQEvent.htm">QEvent</a> *e)<br/>
    {<br/>
    &nbsp;&nbsp;<a href="CppQDialog.htm">QDialog</a>::changeEvent(e);<br/>
    &nbsp;&nbsp;<b><a href="CppSwitch.htm">switch</a></b> (e-&gt;type()) {<br/>
    &nbsp;&nbsp;<b><a href="CppCase.htm">case</a></b> <a href="CppQEvent.htm">QEvent</a>::LanguageChange:<br/>
    &nbsp;&nbsp;&nbsp;&nbsp;ui-&gt;retranslateUi(<b><a href="CppThis.htm">this</a></b>);<br/>
    &nbsp;&nbsp;&nbsp;&nbsp;<b><a href="CppBreak.htm">break</a></b>;<br/>
    &nbsp;&nbsp;<b><a href="CppDefault.htm">default</a></b>:<br/>
    &nbsp;&nbsp;&nbsp;&nbsp;<b><a href="CppBreak.htm">break</a></b>;<br/>
    &nbsp;&nbsp;}<br/>
    }<br/>
    <br/>
    <b><a href="CppVoid.htm">void</a></b> Dialog::OnTick()<br/>
    {<br/>
    &nbsp;&nbsp;<a href="CppOperatorIncrement.htm">++</a>m_z;<br/>
    &nbsp;&nbsp;<b><a href="CppFor.htm">for</a></b> (<b><a href="CppInt.htm">int</a></b> x <a href="CppOperatorAssign.htm">=</a> 0; x<a href="CppOperatorNotEqual.htm">!=</a>256; <a href="CppOperatorIncrement.htm">++</a>x)<br/>
    &nbsp;&nbsp;{<br/>
    &nbsp;&nbsp;&nbsp;&nbsp;<b><a href="CppFor.htm">for</a></b> (<b><a href="CppInt.htm">int</a></b> y <a href="CppOperatorAssign.htm">=</a> 0; y<a href="CppOperatorNotEqual.htm">!=</a>256; <a href="CppOperatorIncrement.htm">++</a>y)<br/>
    &nbsp;&nbsp;&nbsp;&nbsp;{<br/>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_painter.setPen(QColor((m_z+x)%256,(m_z+y)%256,(m_z+x+y)%256));<br/>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_painter.draw<a href="CppPointer.htm">Point</a>(x,y);<br/>
    &nbsp;&nbsp;&nbsp;&nbsp;}<br/>
    &nbsp;&nbsp;}<br/>
    &nbsp;&nbsp;ui-&gt;label-&gt;setPixmap(m_bitmap);<br/>
    }<br/>
    <br/>
    <b><a href="CppVoid.htm">void</a></b> Dialog::OnClick()<br/>
    {<br/>
    &nbsp;&nbsp;m_z<a href="CppOperatorPlusAssign.htm">+=</a>128;<br/>
    }<br/>
    </code></td></tr></table>
    <!-- end of the code -->
  </li>
</ol>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>Step #5: Running the program</h2>
<p>&nbsp;</p>
<ol>
  <li>Press CTRL-R to start the program</li>
  <li>Your screen might then look like <a href="CppQtBitmapDrawGui.png">this</a></li>
</ol>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><a href="Cpp.htm">Go back to Richel Bilderbeek's C++ page</a>.</p>
<p><a href="index.htm">Go back to Richel Bilderbeek's homepage</a>.</p>
<p>&nbsp;</p>
<p><a href="http://validator.w3.org/check?uri=referer"><img src="valid-xhtml10.png" alt="Valid XHTML 1.0 Strict" height="31" width="88" /></a></p>
</body>
</html>
